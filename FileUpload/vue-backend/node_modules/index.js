const http=require('http');
const server=http.createServer();
const Controller=require('./controller')
const controller=new Controller();

server.on("request",async(req,res)=>{
    res.setHeader("Access-Control-Allow-Origin","*");
    res.setHeader("Access-Control-Allow-Header","*");


    if(req.method ==='OPTIONS'){
        console.log("在这和位置rs");
        res.status=200;
        res.end();
        return;
    }
   if(req.url=='/verify'){
       //res.end('verify');
       console.log("url2:"+req.url);
       await controller.handleVerifyUpload(req,res);
   }
   if(req.url=='/'){
       //上传切片处理
       console.log("/:"+req.url);
       await controller.handleFormData(req,res);
   } 
   if(req.url=='/merge'){
        console.log("/merge:"+req.url);
       await controller.handleMerge(req,res);
   }
});
server.listen(3000,()=>console.log("正在监听3000端口..."));